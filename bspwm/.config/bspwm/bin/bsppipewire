#!/usr/bin/env bash
# https://github.com/polybar/polybar-scripts/tree/master/polybar-scripts/pipewire-simple

getDefaultSink() {
    defaultSink=$(pactl info | awk -F : '/Default Sink:/{print $2}')
    description=$(pactl list sinks | sed -n "/${defaultSink}/,/Description/s/^\s*Description: \(.*\)/\1/p")
    echo "${description}"
}

getDefaultSource() {
    defaultSource=$(pactl info | awk -F : '/Default Source:/{print $2}')
    description=$(pactl list sources | sed -n "/${defaultSource}/,/Description/s/^\s*Description: \(.*\)/\1/p")
    echo "${description}"
}

echoVolume() {
  icon="${1}";
  echo "${icon}$(pamixer --get-volume-human)";
}

case $1 in
    "--up")
        pamixer --increase 1 && echoVolume "vol: "
        ;;
    "--down")
        pamixer --decrease 1 && echoVolume "vol: "
        ;;
    "--mute")
        pamixer --toggle-mute && echoVolume "vol: "
        ;;
    "--volume")
        echoVolume "vol: "
        ;;
    *)
      echo "Source: $(getDefaultSource) | Sink: $(echoVolume "") $(getDefaultSink)"
esac
